{% extends "base.html" %}

{% block main %}
<style>
#progressbar {
		width: 400px;
		height: 22px;
		border: 1px solid #111;
		background-color: #292929;
}

#progressbar div {
		height: 100%;
		color: #fff;
		text-align: right;
		line-height: 22px; /* same as #progressbar height if we want text middle aligned */
		width: 0;
		background-color: #0099ff;
}
</style>
<script type="text/javascript">
	function answer(group,question,answer) {
		$.ajax({
		  url: "/answer/"+question.toString()+"/"+answer.toString()
		}).done(function() {			
			if (question < {{ questions | length }}) {
				$('#q'+question.toString()).hide();			
				$('#q'+(question+1).toString()).show();							
				progress();
			} else {
				window.location ="/questionare/{{ group.order + 1 }}";				
			}
		});
	}
	var myProgress = {{ session['progress'] }};
	function progress() {		
		myProgress = myProgress + 1;    	
		updateProgress();
  	}
  	function updateProgress() {
  		var percent = Math.round(100 * myProgress / {{ config.num_questions }});
		var progressBarWidth = percent * $('#progressbar').width() / 100;
		var progressDiv = $('#progressbar').find('div');
		progressDiv.animate({ width: progressBarWidth }, 500);
		if (percent % 25 == 0) {
			progressDiv.html(percent + "%&nbsp;");
		} else {
			progressDiv.html("&nbsp;");
		}
	}

  	function next() {
  		$("#nextBtn").hide();
  		$("#q1").show();
  	}
  	window.onload = function()
    {
    	updateProgress();
    };

</script>

<div class="row-fluid">
	<div class="span8 offset1">
		<h2>Questionare</h2>
		<h3>{{ group.name }}</h3>
		{{ group.title }}
		<br>		
		<br>
		<a href="javascript:next()" id="nextBtn"><button class="btn btn-large"><i class="icon-arrow-right"></i> Next</button></a>

		{% for q in questions %}
		<div id="q{{q.order}}" style="display:none">
			<h4>{{ q.title }}</h4>
			<table style="height:100px;width:500px;">

				<tr>
					{% for index in range(1,6) %}
					<td bgcolor="{{ config.COLORS[index] }}" style="height:100px;width=100px">
						<a href="javascript:answer({{ group.order }},{{ q.order }},{{ index }})" style="display:block;width:100%;height:100%;text-decoration:none;">&nbsp;
						</a>
					</td>
					{% endfor %}
				</tr>
			</table>
		</div>
		{% endfor %}		
		
		<br>
		<br>
	</div>
</div>

<div class="row-fluid">
<div class="span8 offset1" id="progressbar"><div></div></div>
</div>

{% endblock main %}
